$(document).ready(function(){$(".QRMsgArea").markItUp(mySettings);$("#emoticons a").click(function(){emoticon=$(this).attr("rel");$.markItUp({replaceWith:emoticon})});if(updPostId!="undefined"){$("#"+updPostId).click(function(){var a=$get(imgTagId).innerHTML;var b=$("#caretP").val();$("#"+messageId).focus();setCaretPosition($get(messageId),b);$.markItUp({replaceWith:a});$find("mpUpload").hide();return false})}$("img.imgSelect").click(function(){src=$(this).attr("rel");var a=$("#caretP").val();$("#"+messageId).focus();setCaretPosition($get(messageId),a);$.markItUp({replaceWith:"[img]"+src+"[/img]"});$find("mpBrowse").hide()})});function ShowImageBrowser(){var a=getCaret($get(messageId));$("#caretP").val(a);$find("mpBrowse").show()}function ShowUpload(){var a=getCaret($get(messageId));$("#caretP").val(a);$find("mpUpload").show()}function getCaret(a){if(a.selectionStart){return a.selectionStart}else{if(document.selection){a.focus();var b=document.selection.createRange();if(b==null){return 0}var d=a.createTextRange(),c=d.duplicate();d.moveToBookmark(b.getBookmark());c.setEndPoint("EndToStart",d);return c.text.length}}return 0}function setCaretPosition(a,b){if($.browser.mozilla||$.browser.opera||$.browser.safari){a.focus();a.setSelectionRange(b,b)}else{if($.browser.msie){var c=a.createTextRange();c.collapse(true);c.moveEnd("character",b);c.moveStart("character",b);c.select()}}};